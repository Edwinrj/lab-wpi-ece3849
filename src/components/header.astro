---
import type { Props } from "@astrojs/starlight/props";
import SiteTitle from "@astrojs/starlight/components/SiteTitle.astro";
import SocialIcons from "@astrojs/starlight/components/SocialIcons.astro";
import OramaSearchReact from './OramaSearchReact.jsx';

const { siteTitle, siteTitleHref } = Astro.props;
---

<header
	class="sl-flex sl-items-center sl-justify-between sl-px-4 sl-py-2 sm:sl-px-6 sl-bg-[var(--sl-color-white)] dark:sl-bg-[var(--sl-color-black)] sl-z-[1000] sl-sticky sl-top-0"
>
	<!-- Logo y título -->
	<div class="sl-flex sl-items-center sl-gap-4">
		<SiteTitle title={siteTitle} href={siteTitleHref} />
	</div>

	<!-- Íconos y utilidades -->
	<div class="sl-flex sl-items-center sl-gap-3">
			<SocialIcons />
			<OramaSearchReact client:idle />

		<!-- Botón de toggle tema personalizado - más pequeño y al final -->
		<button
			id="theme-toggle"
			class="sl-flex sl-items-center sl-justify-center sl-w-8 sl-h-8 sl-rounded-md sl-border sl-border-gray-300 dark:sl-border-gray-600 sl-bg-white dark:sl-bg-gray-800 hover:sl-bg-gray-100 dark:hover:sl-bg-gray-700 sl-transition-colors"
			aria-label="Toggle theme"
		>
			<!-- Sol (modo claro) -->
			<svg
				id="sun-icon"
				class="sl-w-4 sl-h-4 sl-text-yellow-500"
				fill="currentColor"
				viewBox="0 0 20 20"
			>
				<path
					fill-rule="evenodd"
					d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"
					clip-rule="evenodd"></path>
			</svg>
			<!-- Luna (modo oscuro) -->
			<svg
				id="moon-icon"
				class="sl-w-4 sl-h-4 sl-text-blue-400 sl-hidden"
				fill="currentColor"
				viewBox="0 0 20 20"
			>
				<path
					d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"
				></path>
			</svg>
		</button>
	</div>
</header>

<script>
	// Script para el toggle de tema
	document.addEventListener("DOMContentLoaded", () => {
		const themeToggle = document.getElementById("theme-toggle");
		const sunIcon = document.getElementById("sun-icon");
		const moonIcon = document.getElementById("moon-icon");

		// Función para actualizar los iconos
		function updateIcons() {
			const isDark =
				document.documentElement.getAttribute("data-theme") === "dark";
			if (isDark) {
				sunIcon?.classList.add("sl-hidden");
				moonIcon?.classList.remove("sl-hidden");
			} else {
				sunIcon?.classList.remove("sl-hidden");
				moonIcon?.classList.add("sl-hidden");
			}
		}

		// Inicializar iconos
		updateIcons();

		// Toggle del tema
		themeToggle?.addEventListener("click", () => {
			const currentTheme =
				document.documentElement.getAttribute("data-theme");
			const newTheme = currentTheme === "dark" ? "light" : "dark";

			document.documentElement.setAttribute("data-theme", newTheme);
			localStorage.setItem("starlight-theme", newTheme);

			updateIcons();
		});

		// Observar cambios en el tema (por si se cambia desde otro lugar)
		const observer = new MutationObserver(updateIcons);
		observer.observe(document.documentElement, {
			attributes: true,
			attributeFilter: ["data-theme"],
		});
	});
</script>

---
title: Lab 3   - Test
---

import { Tabs, TabItem } from '@astrojs/starlight/components';
import { Card, CardGrid } from '@astrojs/starlight/components';
import { LinkCard } from '@astrojs/starlight/components';


Welcome to Lab 0! This comprehensive guide will help you set up your development environment for creating a stopwatch with graphical menu using the MSP430 microcontroller.

## Lab Overview

<Card title="Lab 0 Objectives" icon="rocket">
**Main Goal:** Implement a stopwatch controlled by buttons and a navigable graphical menu.

**Key Learning Topics:**
- Peripheral initialization
- Button debouncing techniques
- Timer interrupt service routines (ISR)
- Display management systems
- Modular code structure design
</Card>

## Prerequisites

Before diving into Lab 0, ensure you have all necessary components ready:

<CardGrid>
<Card title="Hardware Requirements" icon="laptop">
- **MSP430 Development Board** (MSP430FR5994 or equivalent)
- **Graphical LCD Display** (128x64 pixels recommended)
- **Push buttons** (minimum 4 for navigation)
- **Breadboard and jumper wires**
- **USB cable** for programming and power
</Card>

<Card title="Software Requirements" icon="setting">
- **Code Composer Studio (CCS)** v12.0+
- **MSP430 compiler tools**
- **Device support packages**
- **Git** (recommended for version control)
</Card>
</CardGrid>

## Installing Code Composer Studio

<LinkCard
  title="Download CCS"
  description="Get the latest version from Texas Instruments"
  href="https://www.ti.com/tool/CCSTUDIO"
/>

### Installation Process

<Tabs>
<TabItem label="Windows">
1. **Download the Windows installer** (`.exe` file)
2. **Run as Administrator** to ensure proper installation
3. **Select installation directory** (default: `C:\ti\ccs1250\`)
4. **Choose components:**
   - ‚úÖ MSP430 compiler tools
   - ‚úÖ MSP430 device support
   - ‚úÖ Debug probes support
   - ‚úÖ MSP430 LaunchPad drivers

```bash
# Installation typically takes 10-15 minutes
# Total size: ~2.5GB
```

5. **Restart your computer** after installation
6. **Launch CCS** and verify installation
</TabItem>

<TabItem label="Linux">
1. **Download the Linux installer** (`.run` file)
2. **Make executable and run:**
```bash
chmod +x ccs_setup_12.7.0.00007_linux-x64.run
sudo ./ccs_setup_12.7.0.00007_linux-x64.run
```
3. **Select installation directory** (default: `/opt/ti/ccs1250/`)
4. **Install dependencies:**
```bash
sudo apt-get update
sudo apt-get install libc6:i386 libusb-0.1-4 libgconf-2-4
```
5. **Add user to dialout group:**
```bash
sudo usermod -a -G dialout $USER
```
6. **Log out and log back in** for group changes to take effect
</TabItem>

<TabItem label="macOS">
1. **Download the macOS installer** (`.dmg` file)
2. **Mount the disk image** and run the installer
3. **Allow installation from identified developer** in System Preferences
4. **Select installation directory** (default: `/Applications/ti/ccs1250/`)
5. **Install Xcode Command Line Tools** if prompted:
```bash
xcode-select --install
```
6. **Grant permissions** for USB access when prompted
</TabItem>
</Tabs>

### Post-Installation Setup

After CCS installation, configure device support:

<Tabs>
<TabItem label="Automatic Setup">
1. **Launch CCS**
2. **Navigate to:** Help ‚Üí Install New Software
3. **Click "Add"** and select "MSP430 Support"
4. **Install recommended packages:**
   - MSP430 compiler tools (latest)
   - MSP430Ware driver library
   - Energy Trace technology
</TabItem>

<TabItem label="Manual Setup">
1. **Download MSP430Ware** separately from TI website
2. **Extract to:** `C:\ti\msp430ware` (Windows) or `/opt/ti/msp430ware` (Linux/macOS)
3. **Add to CCS:** Window ‚Üí Preferences ‚Üí Code Composer Studio ‚Üí Products
4. **Browse and add** MSP430Ware installation path
</TabItem>
</Tabs>

:::tip[Installation Tip]
If you encounter permission issues, ensure CCS is run with appropriate administrator/root privileges during the first launch.
:::

## Project Setup

### Creating Your Lab 0 Project

<Tabs>
<TabItem label="New Project Wizard">
1. **Launch Code Composer Studio**
2. **Create workspace:** `C:\ti\workspace_ece3849` (Windows) or `~/ti/workspace_ece3849` (Linux/macOS)
3. **File ‚Üí New ‚Üí CCS Project**
4. **Configure project settings:**
   - **Family:** MSP430
   - **Variant:** MSP430FR5994 (or your specific device)
   - **Connection:** MSP430 LaunchPad
   - **Project name:** `Lab0_Stopwatch`
   - **Template:** Empty project (add main.c)
   - **Compiler:** TI v21.6.0.LTS or later
</TabItem>

<TabItem label="Import Template">
If you have a template project:
1. **File ‚Üí Import ‚Üí General ‚Üí Existing Projects**
2. **Browse to template location**
3. **Select project** and click "Finish"
4. **Right-click project ‚Üí Rename** to `Lab0_Stopwatch`
5. **Update all references** in code files
</TabItem>
</Tabs>

### Recommended Project Structure

Organize your project with this modular structure:

```
Lab0_Stopwatch/
‚îú‚îÄ‚îÄ üìÅ src/
‚îÇ   ‚îú‚îÄ‚îÄ main.c                    # Main application entry point
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ hardware/              # Hardware abstraction layer
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ gpio.c/.h             # GPIO initialization and control
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ timer.c/.h            # Timer configuration and ISR
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ lcd.c/.h              # LCD display driver functions
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ adc.c/.h              # ADC configuration (if needed)
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ ui/                    # User interface components
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ menu.c/.h             # Menu system implementation
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ stopwatch.c/.h        # Stopwatch functionality
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ display.c/.h          # Display management
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ utils/                 # Utility functions
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ debounce.c/.h         # Button debouncing utilities
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ringbuffer.c/.h       # Data structures
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ math_utils.c/.h       # Mathematical functions
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ config/                # Configuration files
‚îÇ       ‚îú‚îÄ‚îÄ system_config.h       # System-wide constants
‚îÇ       ‚îî‚îÄ‚îÄ pin_config.h          # Pin definitions
‚îú‚îÄ‚îÄ üìÅ docs/                      # Documentation
‚îÇ   ‚îú‚îÄ‚îÄ README.md                 # Project documentation
‚îÇ   ‚îú‚îÄ‚îÄ hardware_setup.md         # Hardware connection guide
‚îÇ   ‚îî‚îÄ‚îÄ user_manual.md            # User manual
‚îî‚îÄ‚îÄ üìÅ tests/                     # Test files (optional)
    ‚îú‚îÄ‚îÄ test_timer.c              # Timer unit tests
    ‚îî‚îÄ‚îÄ test_menu.c               # Menu system tests
```

## Hardware Connections

### MSP430 LaunchPad Pinout

<Card title="Important Note" icon="warning">
Always **power off** your LaunchPad before making connections to prevent damage to the microcontroller or peripherals.
</Card>

### LCD Display Connections

<Tabs>
<TabItem label="Parallel Interface">
Connect your LCD display using the following pinout:

| LCD Pin | MSP430 Pin | Function | Notes |
|---------|------------|----------|-------|
| **VDD** | 3.3V | Power | Use LaunchPad 3.3V rail |
| **VSS** | GND | Ground | Common ground |
| **V0** | Potentiometer | Contrast | 10kŒ© pot for contrast control |
| **RS** | P1.0 | Register Select | Data/Command selection |
| **E** | P1.1 | Enable | Clock signal |
| **D4** | P1.4 | Data Bit 4 | 4-bit mode |
| **D5** | P1.5 | Data Bit 5 | 4-bit mode |
| **D6** | P1.6 | Data Bit 6 | 4-bit mode |
| **D7** | P1.7 | Data Bit 7 | 4-bit mode |
| **A** | 3.3V | Backlight Anode | Through 220Œ© resistor |
| **K** | GND | Backlight Cathode | Direct connection |

```c
// Pin definitions for LCD
#define LCD_RS_PIN  BIT0  // P1.0
#define LCD_E_PIN   BIT1  // P1.1
#define LCD_DATA_PINS (BIT4 | BIT5 | BIT6 | BIT7)  // P1.4-P1.7
```
</TabItem>

<TabItem label="SPI Interface">
For SPI-based LCD displays:

| LCD Pin | MSP430 Pin | Function |
|---------|------------|----------|
| **VCC** | 3.3V | Power |
| **GND** | GND | Ground |
| **SCK** | P1.5 (UCB0CLK) | SPI Clock |
| **SDA** | P1.6 (UCB0SIMO) | SPI Data |
| **CS** | P1.3 | Chip Select |
| **DC** | P1.2 | Data/Command |
| **RST** | P1.4 | Reset |

```c
// Pin definitions for SPI LCD
#define LCD_CS_PIN   BIT3  // P1.3
#define LCD_DC_PIN   BIT2  // P1.2
#define LCD_RST_PIN  BIT4  // P1.4
```
</TabItem>
</Tabs>

### Button Configuration

<Card title="Button Wiring" icon="puzzle">
Configure buttons for menu navigation and stopwatch control:
</Card>

| Button | MSP430 Pin | Function | Pull-up |
|--------|------------|----------|---------|
| **BTN1** | P2.0 | Start/Stop Stopwatch | Internal |
| **BTN2** | P2.1 | Reset Stopwatch | Internal |
| **BTN3** | P2.2 | Menu Up/Previous | Internal |
| **BTN4** | P2.3 | Menu Down/Next | Internal |
| **BTN5** | P2.4 | Menu Select/Enter | Internal |

```c
// Button pin definitions
#define BTN_START_STOP  BIT0  // P2.0
#define BTN_RESET       BIT1  // P2.1
#define BTN_MENU_UP     BIT2  // P2.2
#define BTN_MENU_DOWN   BIT3  // P2.3
#define BTN_MENU_SELECT BIT4  // P2.4

// Enable internal pull-up resistors
#define BTN_ALL_PINS (BTN_START_STOP | BTN_RESET | BTN_MENU_UP | BTN_MENU_DOWN | BTN_MENU_SELECT)
```

:::note[Pull-up Resistors]
Enable internal pull-up resistors for all button inputs to ensure proper logic levels and reduce external component count.
:::

### Optional: LED Indicators

| LED | MSP430 Pin | Function |
|-----|------------|----------|
| **LED1** | P1.0 | Status indicator |
| **LED2** | P9.7 | Stopwatch running |

## Compiler Configuration

### Build Settings Optimization

<Tabs>
<TabItem label="Debug Configuration">
Optimized for development and debugging:

```c
// Project Properties ‚Üí Build ‚Üí MSP430 Compiler ‚Üí Optimization
Optimization Level: None (-O0)
Debug Level: Maximum (-g3)
```

**Additional Debug Settings:**
- Enable all warnings (`-Wall`)
- Treat warnings as errors (`-Werror`)
- Generate debug information (`-g3`)
- Disable optimizations (`-O0`)

```c
// Compiler flags for debug
-g3 -Wall -Werror -O0 -std=c99
```
</TabItem>

<TabItem label="Release Configuration">
Optimized for performance and size:

```c
// Project Properties ‚Üí Build ‚Üí MSP430 Compiler ‚Üí Optimization
Optimization Level: Size (-Os)
Debug Level: None
```

**Additional Release Settings:**
- Enable size optimizations (`-Os`)
- Remove unused functions (`-ffunction-sections`)
- Remove unused data (`-fdata-sections`)

```c
// Compiler flags for release
-Os -ffunction-sections -fdata-sections -std=c99
```
</TabItem>
</Tabs>

### Linker Configuration

<Tabs>
<TabItem label="Memory Settings">
Configure memory allocation for your project:

```c
// Project Properties ‚Üí Build ‚Üí MSP430 Linker ‚Üí Basic Options
Heap Size: 512 bytes
Stack Size: 256 bytes
```

**Memory Map (MSP430FR5994):**
- **Flash:** 256KB (0x4400 - 0x43FFF)
- **SRAM:** 8KB (0x1C00 - 0x3BFF)
- **Information Memory:** 512B (0x1800 - 0x19FF)
</TabItem>

<TabItem label="Advanced Settings">
Advanced linker options for optimization:

```c
// Enable garbage collection
--gc-sections

// Remove unused sections
--remove-unused-sections

// Generate map file
--map-file=Lab0_Stopwatch.map
```
</TabItem>
</Tabs>

## Testing Your Setup

### Basic Hardware Verification

Create a comprehensive test program to verify your setup:

<Tabs>
<TabItem label="LED Blink Test">
```c
#include <msp430.h>

int main(void) {
    WDTCTL = WDTPW | WDTHOLD;   // Stop watchdog timer
    PM5CTL0 &= ~LOCKLPM5;       // Disable GPIO power-on default high-impedance mode
    
    // Configure LED pins
    P1DIR |= BIT0;              // Set P1.0 as output (LED1)
    P9DIR |= BIT7;              // Set P9.7 as output (LED2)
    
    // Initialize LEDs OFF
    P1OUT &= ~BIT0;
    P9OUT &= ~BIT7;
    
    while(1) {
        P1OUT ^= BIT0;          // Toggle LED1
        P9OUT ^= BIT7;          // Toggle LED2
        __delay_cycles(500000); // Delay ~0.5 seconds at 1MHz
    }
}
```
</TabItem>

<TabItem label="Button Test">
```c
#include <msp430.h>

int main(void) {
    WDTCTL = WDTPW | WDTHOLD;   // Stop watchdog timer
    PM5CTL0 &= ~LOCKLPM5;       // Disable GPIO power-on default high-impedance mode
    
    // Configure button pins
    P2DIR &= ~(BIT0 | BIT1);    // Set buttons as input
    P2REN |= (BIT0 | BIT1);     // Enable pull-up resistors
    P2OUT |= (BIT0 | BIT1);     // Set pull-up resistors
    
    // Configure LED
    P1DIR |= BIT0;              // Set LED as output
    P1OUT &= ~BIT0;             // Initialize LED OFF
    
    while(1) {
        if(!(P2IN & BIT0)) {    // Button pressed (active low)
            P1OUT |= BIT0;      // Turn LED ON
        } else {
            P1OUT &= ~BIT0;     // Turn LED OFF
        }
        __delay_cycles(1000);   // Small delay for debouncing
    }
}
```
</TabItem>

<TabItem label="LCD Test">
```c
#include <msp430.h>

// Basic LCD initialization and test
void lcd_init(void);
void lcd_write_string(char* str);

int main(void) {
    WDTCTL = WDTPW | WDTHOLD;   // Stop watchdog timer
    PM5CTL0 &= ~LOCKLPM5;       // Disable GPIO power-on default high-impedance mode
    
    // Initialize LCD
    lcd_init();
    
    // Display test message
    lcd_write_string("Lab 0 Ready!");
    
    while(1) {
        // Main loop - LCD should display message
        __delay_cycles(1000000);
    }
}

// Add your LCD driver functions here
void lcd_init(void) {
    // LCD initialization code
    // (Implementation depends on your specific LCD)
}

void lcd_write_string(char* str) {
    // LCD string writing code
    // (Implementation depends on your specific LCD)
}
```
</TabItem>
</Tabs>

### Verification Checklist

<CardGrid>
<Card title="Hardware Verification" icon="check">
- ‚úÖ LEDs blink correctly
- ‚úÖ Buttons respond to input
- ‚úÖ LCD displays characters
- ‚úÖ Power consumption is reasonable
- ‚úÖ No loose connections
</Card>

<Card title="Software Verification" icon="code">
- ‚úÖ Project compiles without errors
- ‚úÖ Code downloads to device
- ‚úÖ Debugger connects successfully
- ‚úÖ Breakpoints work properly
- ‚úÖ Variables can be monitored
</Card>
</CardGrid>

## Troubleshooting Common Issues

### Hardware Issues

<Tabs>
<TabItem label="Connection Problems">
**Issue:** "Device not found" or "Connection failed"

**Solutions:**
1. **Check USB cable** - Use a data cable, not charge-only
2. **Verify driver installation** - Reinstall LaunchPad drivers
3. **Check device manager** (Windows) or `lsusb` (Linux)
4. **Try different USB port** - Avoid hubs, use direct connection
5. **Restart CCS** and try again

```bash
# Linux: Check USB device recognition
lsusb | grep -i "texas instruments"

# Windows: Check Device Manager
# Look for "MSP430 Application UART" under Ports
```
</TabItem>

<TabItem label="Programming Issues">
**Issue:** "Flash programming failed"

**Solutions:**
1. **Check target voltage** - Ensure 3.3V is present
2. **Verify connections** - Especially VCC and GND
3. **Reset the device** - Hold reset button while connecting
4. **Check for shorts** - Use multimeter to verify connections
5. **Try different firmware** - Update LaunchPad firmware

```c
// Add this to beginning of main() if having issues
PM5CTL0 &= ~LOCKLPM5;  // Disable GPIO power-on default high-impedance mode
```
</TabItem>
</Tabs>

### Software Issues

<Tabs>
<TabItem label="Compilation Errors">
**Issue:** Build errors or warnings

**Common Solutions:**
1. **Missing includes** - Add required header files
2. **Undefined symbols** - Check function declarations
3. **Path issues** - Verify include paths in project settings
4. **Device mismatch** - Ensure correct MSP430 variant selected

```c
// Common required includes
#include <msp430.h>
#include <stdint.h>
#include <stdbool.h>
#include <string.h>
```
</TabItem>

<TabItem label="Runtime Issues">
**Issue:** Code doesn't behave as expected

**Debugging Steps:**
1. **Use breakpoints** - Step through code execution
2. **Monitor variables** - Add to watch window
3. **Check register values** - Verify peripheral configuration
4. **Add debug prints** - Use printf or LED indicators

```c
// Debug LED toggle macro
#define DEBUG_TOGGLE_LED() (P1OUT ^= BIT0)

// Use in code to track execution
DEBUG_TOGGLE_LED();  // Place at key points
```
</TabItem>
</Tabs>

## Development Best Practices

### Code Organization

<Card title="Modular Design Principles" icon="puzzle">
Follow these principles for maintainable code:

1. **Separation of Concerns** - Each module handles one responsibility
2. **Clear Interfaces** - Well-defined function signatures
3. **Documentation** - Comment complex logic and interfaces
4. **Error Handling** - Check return values and handle edge cases
5. **Testing** - Write unit tests for individual modules
</Card>

### Debugging Strategies

<Tabs>
<TabItem label="Strategic Debugging">
**Effective Debugging Approach:**

1. **Start Simple** - Test basic functionality first
2. **Isolate Problems** - Comment out complex code
3. **Use Assertions** - Add runtime checks
4. **Log State Changes** - Track variable values
5. **Systematic Testing** - Test one feature at a time

```c
// Example assertion macro
#define ASSERT(condition) \
    if (!(condition)) { \
        while(1) { \
            P1OUT ^= BIT0; \
            __delay_cycles(100000); \
        } \
    }
```
</TabItem>

<TabItem label="Performance Optimization">
**Optimization Techniques:**

1. **Profile Code** - Identify bottlenecks
2. **Optimize Algorithms** - Use efficient data structures
3. **Minimize Interrupts** - Reduce ISR overhead
4. **Power Management** - Use low-power modes
5. **Memory Usage** - Optimize RAM and Flash usage

```c
// Performance monitoring
volatile uint32_t cycle_count = 0;

// Before critical section
uint32_t start_time = __read_cycle_counter();

// Your code here

// After critical section
cycle_count = __read_cycle_counter() - start_time;
```
</TabItem>
</Tabs>

## Next Steps

<CardGrid>
<Card title="Phase 1: Hardware Setup" icon="laptop">
**Tasks:**
- Complete hardware connections
- Verify all components work
- Test basic GPIO functionality
- Implement button debouncing
</Card>

<Card title="Phase 2: Display System" icon="monitor">
**Tasks:**
- Initialize LCD display
- Create display driver functions
- Implement menu rendering
- Add graphical elements
</Card>

<Card title="Phase 3: Stopwatch Logic" icon="clock">
**Tasks:**
- Configure timer for accurate timing
- Implement start/stop functionality
- Add reset capability
- Display time formatting
</Card>

<Card title="Phase 4: Menu System" icon="list">
**Tasks:**
- Design menu structure
- Implement navigation logic
- Add settings options
- Integrate with stopwatch
</Card>
</CardGrid>

## Resources and Documentation

<LinkCard
  title="MSP430FR5994 LaunchPad User Guide"
  description="Complete hardware documentation and examples"
  href="https://www.ti.com/lit/ug/slau677c/slau677c.pdf"
/>

<LinkCard
  title="MSP430FR5xx/6xx Family User Guide"
  description="Comprehensive peripheral documentation"
  href="https://www.ti.com/lit/ug/slau367p/slau367p.pdf"
/>

<LinkCard
  title="Code Composer Studio User Guide"
  description="IDE features and debugging tools"
  href="https://www.ti.com/tool/CCSTUDIO"
/>

<LinkCard
  title="MSP430 Driver Library"
  description="Pre-built functions for common tasks"
  href="https://www.ti.com/tool/MSPDRIVERLIB"
/>

---

<Card title="Ready to Begin?" icon="rocket">
Your development environment is now configured and ready for Lab 0 implementation. Start with the hardware verification tests, then proceed to implement the stopwatch functionality following the modular structure outlined above.

**Good luck with your embedded systems journey!**
</Card>
